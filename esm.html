<!doctype html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>webp-hero</title>
		<style>
			* { margin: 0; padding: 0; box-sizing: border-box; }
			html {
				background: #222;
				color: #aaa;
				padding: 1em;
			}
			h1 { margin: 1em auto; }
			section { padding: 2em }
			a { color: #fa4; }
		</style>
	</head>
	<body>
		<section>
			<h1>webp-hero</h1>
			<p><a href="https://github.com/chase-moskal/webp-hero">webp-hero github</a></p>
			<p><a href="/libwebp/dist/google/index.html">google's webp demo</a></p>
			<p><a href=".">.</a> standard webp usage</p>
			<p><a href="./?force">?force</a> force webp decoding</p>
			<p><a href="./?force?useCanvasElements">?force?useCanvasElements</a> replace images with canvases</p>
		</section>

		<img alt="" src="images/landscape.webp"/>
		<img alt="" width="300" src="images/dice.webp"/>
		<img alt="" style="width: 800px" src="images/firebreather.webp"/>
		<p>repeated, to test caching</p>
		<img alt="" src="images/landscape.webp"/>
		<img alt="" width="300" src="images/dice.webp"/>
		<img alt="" style="width: 800px" src="images/firebreather.webp"/>

		<script type="module">
			import {WebpMachine} from "./dist/webp-machine.js"

			async function main() {

				// for this demo, you can add "?force" to the url to force webp conversion
				var webpSupport = location.search.indexOf("force") !== -1
					? Promise.resolve(false)
					: undefined

				// you can also add "?useCanvasElements" to the url
				// to replace img elements with canvases
				var useCanvasElements = location.search.indexOf("useCanvasElements") !== -1
					? true
					: false

				// instance the webp machine
				var webpMachine = new WebpMachine({
					webpSupport: webpSupport,
					useCanvasElements: useCanvasElements,
				})
	
				// polyfill this entire document's webp images
				await webpMachine.polyfillDocument()
			}

			main()
				.catch(error => console.error("top level error:", error))
		</script>
	</body>
</html>
